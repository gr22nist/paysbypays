# 기능 설명 문서

> **프로젝트**: PaysByPays Dashboard  
> **버전**: 1.0  
> **최종 업데이트**: 2025-11-28

---

## 1. 개요

PaysByPays Dashboard는 결제대행사를 위한 종합 대시보드 애플리케이션입니다. 거래 내역, 가맹점 관리, 정산, 분석, 시스템 모니터링 등 결제대행사 운영에 필요한 여러러 기능을 제공합니다.

---

## 2. 주요 페이지 및 기능

### 2.1 대시보드 홈 (`/`)

**목적**: 전체 시스템의 핵심 지표를 한눈에 파악

#### 주요 기능

1. **통계 요약 패널** (`DashboardStatsPanel`)
   - 총 거래 금액: 전체 거래 금액 합계
   - 거래 건수: 전체 거래 건수
   - 승인률: 승인된 거래 비율
   - 평균 거래 금액: 거래당 평균 금액
   - **데이터 소스**: `useTransactionSummary` 훅을 통한 API 집계

2. **거래 트렌드 차트** (`TransactionTrendChart`)
   - 시간대별 승인/실패 거래 추이 시각화
   - Recharts 라이브러리 사용
   - **데이터 소스**: `useTransactionChart` 훅

3. **최다 거래 가맹점 TOP 5** (`TopMerchantsList`)
   - 거래 금액 기준 상위 5개 가맹점
   - 거래 건수 기준 상위 5개 가맹점
   - 클릭 시 해당 가맹점 상세 페이지로 이동

4. **최근 거래 내역** (`RecentTransactionsTable`)
   - 최근 거래 10건 표시
   - 거래 코드, 가맹점, 금액, 상태, 결제 수단, 결제 시각
   - 행 클릭 시 거래 상세 Drawer 열림

5. **시스템 상태 카드** (`SystemHealthCard`)
   - 주요 API 그룹 상태 모니터링
   - 자동 갱신 (30초 간격)
   - 상태별 색상 표시 (정상/지연/오류)

6. **정산 알림 카드** (`SettlementAlertCard`)
   - 지급 예정 정산 건수
   - 지급 지연 정산 건수
   - 클릭 시 정산 페이지로 이동

7. **가맹점 상태 요약** (`MerchantStatusSummary`)
   - 활성/비활성 가맹점 수
   - 전체 가맹점 수

#### 기술 구현
- **컴포넌트 구조**: 각 섹션을 독립 컴포넌트로 분리
- **데이터 페칭**: 여러 훅을 병렬로 사용하여 데이터 로드
- **성능 최적화**: `useMemo`를 통한 계산 결과 캐싱

---

### 2.2 거래 내역 페이지 (`/transactions`)

**목적**: 모든 거래 내역을 필터링, 정렬, 검색하여 조회

#### 주요 기능

1. **통계 패널** (`TransactionStatsPanel`)
   - 총 거래 금액
   - 총 거래 건수
   - 승인 건수
   - 실패 건수
   - **필터 적용**: 선택한 필터에 따라 통계 자동 업데이트

2. **필터 패널** (`TransactionFilterPanel`)
   - **거래 상태 필터**: SUCCESS, FAILED, CANCELLED
   - **결제 수단 필터**: 카드, 휴대폰, 온라인, 단말기 등
   - **날짜 범위 필터**: 오늘, 지난 7일, 이번 달, 지난 달, 전체
   - **가맹점 코드 필터**: URL 파라미터로 전달된 가맹점 코드 자동 적용
   - **필터 초기화**: 모든 필터를 한 번에 초기화

3. **거래 내역 테이블** (`TransactionTable`)
   - **컬럼**: 거래 코드, 가맹점, 금액, 상태, 결제 수단, 결제 시각
   - **정렬**: 각 컬럼 클릭 시 오름차순/내림차순 정렬
   - **페이징**: 10, 25, 50, 100건 선택 가능
   - **행 클릭**: 거래 상세 Drawer 열림
   - **데이터 내보내기**: Excel/CSV 형식으로 내보내기

4. **거래 상세 Drawer** (`TransactionDetailDrawer`)
   - 거래 기본 정보 (코드, 금액, 상태, 결제 수단, 결제 시각)
   - 가맹점 정보 (코드, 이름, 상태)
   - 관련 링크 (가맹점 상세, 해당 가맹점 거래 내역)

#### 기술 구현
- **상태 관리**: `useTransactionTable` 훅으로 필터링/정렬/페이징 로직 캡슐화
- **Drawer 관리**: `useTransactionDrawer` 훅으로 Drawer 상태 관리
- **필터 동기화**: Zustand `filter-store`를 통한 전역 필터 상태 관리

---

### 2.3 가맹점 관리 페이지 (`/merchants`)

**목적**: 가맹점 목록 조회 및 관리

#### 주요 기능

1. **통계 패널** (`MerchantStatsPanel`)
   - 전체 가맹점 수
   - 활성 가맹점 수
   - 비활성 가맹점 수
   - 활성 비율

2. **필터 패널** (`MerchantFilterPanel`)
   - **검색**: 가맹점 코드 또는 이름으로 검색
   - **상태 필터**: 활성, 비활성, 정지 등
   - **필터 초기화**

3. **가맹점 테이블** (`MerchantTable`)
   - **컬럼**: 가맹점 코드, 가맹점명, 상태, 사업자 유형
   - **정렬**: 각 컬럼 클릭 시 정렬
   - **페이징**: 10, 25, 50, 100건 선택 가능
   - **행 클릭**: 가맹점 상세 페이지로 이동
   - **데이터 내보내기**: Excel/CSV 형식으로 내보내기

4. **가맹점 상세 페이지** (`/merchants/[mchtCode]`)
   - **통계 패널**: 해당 가맹점의 거래 통계
   - **기본 정보 카드**: 가맹점 코드, 이름, 상태, 사업자 유형
   - **연락처 정보 카드**: 사업자 등록번호, 주소, 전화번호, 이메일, 등록일
   - **거래 내역 테이블**: 해당 가맹점의 거래만 필터링하여 표시

5. **가맹점 등록 페이지** (`/merchants/new`)
   - **폼 필드**: 가맹점명, 사업자 유형, 사업자 등록번호, 주소, 전화번호, 이메일, 상태
   - **유효성 검사**: 클라이언트 측 유효성 검사
   - **성공 화면**: 등록 완료 후 가맹점 목록으로 자동 이동

#### 기술 구현
- **폼 관리**: `useMerchantForm` 훅으로 폼 상태 및 유효성 검사 관리
- **컴포넌트 분리**: `MerchantFormFields`, `MerchantFormActions`, `MerchantFormSuccess`로 분리

---

### 2.4 정산 페이지 (`/settlements`)

**목적**: 정산 내역 조회 및 관리

#### 주요 기능

1. **정산 통계 패널** (`SettlementStatsPanel`)
   - 총 정산 금액 (수수료 제외 전)
   - 총 지급 금액 (수수료 제외 후)
   - 지급 예정 건수
   - 지급 완료 건수
   - 지급 지연 건수

2. **정산 타임라인 차트** (`SettlementTimelineChart`)
   - 월별 정산 금액 추이
   - Recharts 라이브러리 사용
   - 수수료 제외 전/후 비교 가능

3. **빠른 액션 카드** (`QuickActionCard`)
   - 지급 예정 정산 보기
   - 지급 지연 정산 보기
   - 전체 정산 보기

4. **정산 내역 테이블** (`SettlementRecordsTable`)
   - **컬럼**: 정산 ID, 가맹점, 정산 기간, 총 거래 금액, 수수료, 지급 금액, 지급 상태, 지급 예정일
   - **페이징**: 10, 25, 50, 100건 선택 가능
   - **데이터 내보내기**: Excel/CSV 형식으로 내보내기

#### 기술 구현
- **데이터 병합**: `useSettlements` 훅에서 실제 거래 데이터와 Mock 데이터 병합
- **수수료 계산**: 클라이언트 측에서 수수료 계산 (기본 2.5%)
- **가맹점 이름 매핑**: 가맹점 코드를 이름으로 변환

---

### 2.5 분석 페이지 (`/analytics`)

**목적**: 거래 데이터 분석 및 통계

#### 주요 기능

1. **통계 패널** (`AnalyticsStatsPanel`)
   - 총 거래 금액
   - 총 거래 건수
   - 승인률
   - 평균 거래 금액

2. **평균 거래 금액 카드** (`AverageAmountCard`)
   - 전체 평균 거래 금액
   - 전일 대비 변화율

3. **거래 트렌드 차트** (`AnalyticsTransactionTrendChart`)
   - 시간대별 거래 추이
   - 승인/실패 구분

4. **승인률 차트** (`ApprovalRateChart`)
   - 시간대별 승인률 추이
   - 목표 승인률 대비 비교

5. **결제 수단별 통계** (`PayTypeStatsPanel`)
   - 결제 수단별 거래 금액
   - 결제 수단별 거래 건수
   - 바 차트 시각화

6. **상위 가맹점 테이블** (`TopMerchantsTable`)
   - 거래 금액 기준 상위 10개 가맹점
   - 거래 건수 기준 상위 10개 가맹점

7. **상태 분포 패널** (`StatusDistributionPanel`)
   - 거래 상태별 분포 (승인/실패/취소)
   - 파이 차트 시각화

#### 기술 구현
- **날짜 범위 필터**: 대시보드와 동일한 날짜 범위 선택 기능
- **데이터 집계**: 클라이언트 측에서 거래 데이터 집계

---

### 2.6 설정 페이지 (`/settings`)

**목적**: 사용자 환경 설정

#### 주요 기능

1. **테마 설정** (`ThemeSection`)
   - 라이트 모드 / 다크 모드 / 시스템 설정
   - 폰트 크기 조절 (작게/보통/크게/매우 크게)
   - 실시간 미리보기

2. **언어 및 지역 설정** (`LanguageSection`)
   - 언어 선택: 한국어, 영어, 일본어
   - 날짜 형식: YYYY-MM-DD, YYYY/MM/DD, MM/DD/YYYY
   - 통화: KRW, USD, JPY
   - **자동 매핑**: 언어 변경 시 해당 언어의 기본 통화로 자동 변경

3. **접근성 설정** (`AccessibilitySection`)
   - 고대비 모드: 색상 대비 강화
   - 감소된 모션: 애니메이션 최소화

4. **실시간 미리보기** (`LivePreview`)
   - 설정 변경 시 즉시 미리보기
   - 카드, 버튼, 텍스트 샘플 표시

#### 기술 구현
- **상태 영속성**: Zustand `persist` 미들웨어로 localStorage에 자동 저장
- **전역 적용**: 설정 변경 시 모든 페이지에 즉시 반영
- **테마 동기화**: `AppProviders`에서 테마 상태 동기화

---

### 2.7 시스템 상태 페이지 (`/system-health`)

**목적**: 시스템 헬스 모니터링

#### 주요 기능

1. **전체 상태 요약**
   - 전체 시스템 상태 (정상/지연/오류)
   - 정상 그룹 수
   - 지연 그룹 수
   - 오류 그룹 수
   - 마지막 업데이트 시각

2. **서비스 그룹 상태 테이블**
   - 그룹별 상태 (거래 API, 가맹점 API, 공통 코드 API 등)
   - 응답 시간 (ms)
   - 마지막 확인 시각
   - 오류 메시지

3. **최근 상태 로그**
   - 최근 8개 스냅샷 표시
   - 각 스냅샷의 전체 상태 및 그룹별 상태
   - 타임스탬프

4. **자동 갱신**
   - 30초 간격 자동 폴링
   - 수동 새로고침 버튼
   - 가시성 복귀 시 즉시 새로고침

#### 기술 구현
- **폴링 로직**: `useHealthMonitoring` 훅으로 자동 폴링 관리
- **Mock 데이터**: API 오프라인 시 Mock 데이터로 UI 검증
- **스냅샷 히스토리**: 최근 24개 스냅샷 저장

---

## 3. 공통 기능

### 3.1 다국어 지원 (i18n)

- **지원 언어**: 한국어, 영어, 일본어
- **네임스페이스**: `common`, `dashboard`, `transactions`, `merchants`, `settlements`, `analytics`, `settings`, `layout`
- **동적 로딩**: 필요한 번역만 로드
- **Fallback**: 번역 키가 없을 경우 기본 언어 사용

### 3.2 다크 모드

- **테마 모드**: 라이트, 다크, 시스템 설정
- **CSS 변수**: `var(--background)`, `var(--surface)`, `var(--text-strong)` 등
- **즉시 적용**: 설정 변경 시 모든 페이지에 즉시 반영

### 3.3 반응형 디자인

- **브레이크포인트**: 모바일, 태블릿, 데스크톱
- **그리드 레이아웃**: Tailwind CSS 그리드 시스템 사용
- **사이드바**: 데스크톱에서는 고정, 모바일에서는 오버레이

### 3.4 데이터 내보내기

- **지원 형식**: Excel (.xlsx), CSV
- **필터 적용**: 현재 필터링된 데이터만 내보내기
- **라이브러리**: `exceljs` 사용

### 3.5 접근성

- **키보드 네비게이션**: 모든 인터랙티브 요소 키보드 접근 가능
- **ARIA 레이블**: 스크린 리더 지원
- **고대비 모드**: 색상 대비 강화 옵션
- **감소된 모션**: 애니메이션 최소화 옵션

---

## 4. 기술적 특징

### 4.1 컴포넌트 재사용성

- **30+ 개의 재사용 가능한 컴포넌트**
- **컴포넌트 분리**: 페이지별로 섹션 컴포넌트 분리
- **일관된 디자인**: 모든 페이지에서 동일한 디자인 시스템 사용

### 4.2 상태 관리

- **Zustand 스토어**: 4개의 주요 스토어로 상태 관리
- **로컬 상태**: 컴포넌트별 로컬 상태는 `useState` 사용
- **전역 필터**: `filter-store`로 전역 필터 상태 관리

### 4.3 데이터 페칭

- **커스텀 훅**: 각 도메인별 커스텀 훅 사용
- **에러 처리**: 통일된 에러 처리 패턴
- **로딩 상태**: 각 훅에서 로딩 상태 관리

### 4.4 포맷팅

- **통일된 포맷팅**: `useDisplayFormat` 훅으로 모든 포맷팅 통일
- **사용자 설정 반영**: 언어, 통화, 날짜 형식에 따라 동적 변경
- **환율 변환**: KRW, USD, JPY 간 환율 변환 지원

---

## 5. 사용자 시나리오

### 시나리오 1: 거래 내역 조회
1. 대시보드에서 최근 거래 확인
2. 거래 내역 페이지로 이동
3. 날짜 범위, 상태, 결제 수단으로 필터링
4. 특정 거래 클릭하여 상세 정보 확인
5. 필요 시 Excel로 내보내기

### 시나리오 2: 가맹점 관리
1. 가맹점 목록 페이지에서 가맹점 검색
2. 특정 가맹점 클릭하여 상세 정보 확인
3. 해당 가맹점의 거래 내역 확인
4. 필요 시 새 가맹점 등록

### 시나리오 3: 정산 확인
1. 정산 페이지에서 정산 통계 확인
2. 정산 타임라인 차트로 추이 확인
3. 지급 예정 정산 필터링
4. 정산 내역 Excel로 내보내기

### 시나리오 4: 시스템 모니터링
1. 대시보드에서 시스템 상태 카드 확인
2. 시스템 상태 페이지로 이동하여 상세 확인
3. 서비스 그룹별 상태 확인
4. 최근 상태 로그로 이력 확인

---

## 6. 향후 개선 사항

### 6.1 성능 최적화
- 대용량 데이터 가상화
- React Query 또는 SWR 도입 검토
- 코드 스플리팅 개선

### 6.2 기능 추가
- 실시간 알림 (WebSocket)
- 리포트 생성 및 스케줄링
- 사용자 권한 관리

### 6.3 접근성 개선
- WCAG AA 기준 완전 준수
- 키보드 네비게이션 개선
- 스크린 리더 최적화

---

**문서 작성일**: 2025-11-28  
